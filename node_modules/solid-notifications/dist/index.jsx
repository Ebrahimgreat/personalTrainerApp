import{batch as Q,onMount as G,Show as Z}from"solid-js";import{createMutable as ee}from"solid-js/store";import{createSignal as V}from"solid-js";function v(e,t){if(!e)return;let o=t.rendered.find(a=>a.toastConfig.id===e);return o||t.queued.find(a=>a.toastConfig.id===e)}function P(e,t,o){return o||(!t||t==="__default"?`toast-${e++}`:`${t}:toast-${e}`)}function M(e){return typeof e.toastConfig.content=="function"?e.toastConfig.content(e):e.toastConfig.content||`\u{1F35E} Toast "${e.toastConfig.id}" ready to serve!`}function m(e,t){let o=t.toastConfig[e];return typeof o=="function"?o({theme:t.toastConfig.theme,type:t.toastConfig.type}):o}function D(e){switch(e){case"left":return"start";case"right":return"end";case"center":return"center"}}function W(e){if(!e.toasterConfig.reverseToastOrder)return e.toasterConfig.offsetY;let t=e.rendered[0];return t?t.offset+t.ref?.clientHeight+e.toasterConfig.gutter:e.toasterConfig.offsetY}function x(e,t){let o=a=>a&&typeof a=="object"&&a.constructor===Object;return Array.isArray(e)?t:o(e)&&o(t)?Object.keys(t).reduce((a,n)=>(typeof n!="symbol"&&(a[n]=x(e[n],t[n])),a),{...e}):t}function y(e){if(!e)return{};let t=["positionX","positionY","offsetX","offsetY","gutter","limit","toasterStyle","reverseToastOrder","pauseOnWindowInactive","renderOnWindowInactive"];return Object.fromEntries(Object.entries(e).filter(([a])=>!t.includes(a)))}function $(e){let t=e.toastConfig;switch(e.state){case"entering":if(t.onEnter)return t.onEnter;case"idle":if(t.onIdle)return t.onIdle;case"exiting":if(t.onExit)return t.onExit;default:return`sn-state-${t.positionX}-${t.positionY}-${e.state}`}}function b(e,t){let[o,a]=V(0),n=e?.toastConfig.duration,f=performance.now(),u=0,g=!1,w=()=>{if(!n||!t||g)return;u=performance.now()-f;let C=Math.min(Math.round(u/n*1e4)/100,100);if(a(C),C>=100)return g=!0,t();requestAnimationFrame(w)},r=()=>{g=!1,f=performance.now()-u,requestAnimationFrame(w),e&&(e.isPaused=!1)},i=()=>{g=!0,e&&(e.isPaused=!0)},s=c=>{d(),n=c,f=performance.now()},d=()=>{g=!0,a(0),u=0,e&&(e.isPaused=!0)};return{progress:o,play:r,pause:i,update:s,reset:d}}function I(e){return{pause:()=>{e.progressManager.pause(),e.isPausedByUser=!0},play:()=>{e.progressManager.play(),e.isPausedByUser=!1},reset:()=>{e.progressManager.reset(),e.isPausedByUser=!0},progress:e.progressManager.progress}}function q(e){let t=0,o=0;return{handleDragStart:u=>{e.ref&&e.toastConfig.dragToDismiss&&(t=u.touches[0].clientX,e.ref.style.transition="none",e.progressManager.pause())},handleDragMove:u=>{e.ref&&e.toastConfig.dragToDismiss&&(o=u.touches[0].clientX-t,e.ref.style.transform=`translateX(${o}px)`)},handleDragEnd:()=>{e.ref&&e.toastConfig.dragToDismiss&&(Math.abs(o)>e.toastConfig.dragTreshold?(e.ref.style.transition="all 0.3s ease",e.ref.style.transform=`translateX(${o>0?"100%":"-100%"})`,e.ref.style.opacity="0",e.dismiss(void 0,!1)):(e.progressManager.play(),e.ref.style.transition="all 0.3s ease",e.ref.style.transform="translateX(0)"),t=0,o=0)}}}function X(e,t){!t.toastConfig.dismissOnClick||e.target instanceof HTMLElement&&e.target.closest("a, button, input, select, textarea")||t.dismiss()}function A(e){!e.toastConfig.pauseOnHover||e.store.isWindowBlurred&&e.toastConfig.pauseOnWindowInactive||e.isPausedByUser||e.progressManager.pause()}function F(e){!e.toastConfig.pauseOnHover||e.ref?.contains(document.activeElement)||e.store.isWindowBlurred&&e.toastConfig.pauseOnWindowInactive||e.isPausedByUser||e.progressManager.play()}function O(e){if(!(typeof document>"u")&&e.altKey&&e.key.toLowerCase()==="t"){e.preventDefault();let t=Array.from(document.querySelectorAll('[data-role="toast"]'));if(t.length===0)return;let a=(t.findIndex(n=>document.activeElement===n)+1)%t.length;t[a].focus(),t[a].setAttribute("data-keyboard-focused","true")}}function _(e,t){e.ref&&(e.ref.contains(t.relatedTarget)||(e.ref.removeAttribute("data-keyboard-focused"),!e.isPausedByUser&&e.progressManager.play()))}function L(e){return e.toastConfig.dismissOnClick||!e.toastConfig.showDismissButton?null:<button aria-label="Close notification"class={m("dismissButtonClass",e)}style={m("dismissButtonStyle",e)}onClick={()=>e.dismiss()}>
      <svg aria-hidden="true"xmlns="http://www.w3.org/2000/svg"viewBox="0 0 24 24"width="100%"height="100%">
        <path fill="none"stroke="currentColor"stroke-linecap="round"stroke-linejoin="round"stroke-width="2.5"d="m7 7l10 10M7 17L17 7"/>
      </svg>
    </button>}function j(e){return!e.toastConfig.showProgressBar||!e.toastConfig.duration?null:<div role="progressbar"data-role="progress"class={m("progressBarClass",e)}style={{transform:`scaleX(${(100-e.progressManager?.progress())/100})`,"transform-origin":"left",...m("progressBarStyle",e)}}/>}function H(e){let t=e.toastConfig;if(!t.showIcon)return null;if(t.icon)return typeof t.icon=="function"?t.icon({theme:t.theme,type:t.type}):t.icon;switch(t.type){case"success":return<svg class="sn-icon"xmlns="http://www.w3.org/2000/svg"viewBox="0 0 52 52">
          <circle stroke="currentColor"cx="26"cy="26"r="25"fill="none"/>
          <path fill="none"d="M14.1 27.2l7.1 7.2 16.7-16.8"/>
        </svg>;case"error":return<svg class="sn-icon"xmlns="http://www.w3.org/2000/svg"viewBox="0 0 52 52">
          <circle stroke="currentColor"cx="26"cy="26"r="25"fill="none"/>
          <path fill="none"d="M14.1 14.1l23.8 23.8 m0,-23.8 l-23.8,23.8"/>
        </svg>;case"warning":return<svg class="sn-icon"xmlns="http://www.w3.org/2000/svg"viewBox="0 0 52 52">
          <circle stroke="currentColor"cx="26"cy="26"r="25"fill="none"/>
          <path fill="none"d="M26 9v20M26 34v8"/>
        </svg>;case"info":return<svg class="sn-icon"xmlns="http://www.w3.org/2000/svg"viewBox="0 0 52 52">
          <circle stroke="currentColor"cx="26"cy="26"r="25"fill="none"/>
          <path fill="none"d="M26 9v8M26 22v22"/>
        </svg>;case"loading":return<div class="sn-icon sn-icon-loading"/>;default:return null}}var B=class{setStore;dragManager=q(this);ownProperties;store;toastConfig;ref=null;state="entering";renderedAt;progressManager;isPaused=!0;isPausedByUser=!1;offset=0;constructor(t){return this.store=t.store,this.setStore=t.setStore,this.ownProperties=new Set(Object.keys(t.toastConfig)),this.toastConfig=x(t.store.toasterConfig,t.toastConfig),this.offset=W(t.store),this.progressManager=b(),ee(this)}init(){this.progressManager=b(this,()=>this.dismiss("__expired"));let t=this.store.toasterConfig.limit&&this.store.rendered.length>=this.store.toasterConfig.limit,o=this.store.isWindowBlurred&&!this.store.toasterConfig.renderOnWindowInactive;if(t||o)return this.setStore("queued",[...this.store.queued,this]);this.setStore("rendered",[this,...this.store.rendered])}lifecycle(){!this.renderedAt||(this.state!=="idle"&&setTimeout(()=>this.state="idle",this.toastConfig.enterDuration),this.isPausedByUser)||this.store.isWindowBlurred&&this.toastConfig.pauseOnWindowInactive||this.ref?.contains(document.activeElement)||this.progressManager.play()}update(t){Object.keys(t).forEach(o=>this.ownProperties.add(o)),Object.assign(this.toastConfig,t),this.toastConfig.updateCallback?.(),this.progressManager.update(this.toastConfig.duration),this.lifecycle()}dismiss(t,o=!0){if(this.toastConfig.exitCallback){switch(t){case"__expired":t=!1;break;case void 0:t=!0;break;default:t=t;break}this.toastConfig.exitCallback?.(t)}o&&(this.state="exiting"),setTimeout(()=>{Q(()=>{this.setStore("rendered",a=>a.filter(n=>n.toastConfig.id!==this.toastConfig.id)),this.setStore("queued",a=>a.filter(n=>n.toastConfig.id!==this.toastConfig.id))})},this.toastConfig.exitDuration)}remove(){Q(()=>{this.setStore("rendered",t=>t.filter(o=>o.toastConfig.id!==this.toastConfig.id)),this.setStore("queued",t=>t.filter(o=>o.toastConfig.id!==this.toastConfig.id))})}patch(t){let o=Object.fromEntries(Object.entries(t).filter(([a])=>!this.ownProperties.has(a)));Object.assign(this.toastConfig,o)}render(){return G(()=>{this.renderedAt=Date.now(),this.toastConfig.enterCallback?.(),this.lifecycle()}),<div data-role="toast"tabIndex={0}id={this.toastConfig.id}ref={t=>this.ref=t}role={this.toastConfig.role}aria-live={this.toastConfig.ariaLive}onClick={t=>X(t,this)}onMouseEnter={A.bind(null,this)}onMouseLeave={F.bind(null,this)}onTouchStart={this.dragManager.handleDragStart}onTouchMove={this.dragManager.handleDragMove}onTouchEnd={this.dragManager.handleDragEnd}onFocusIn={this.progressManager.pause}onFocusOut={t=>_(this,t)}onKeyDown={t=>t.key==="Escape"&&this.dismiss()}class={`${m("wrapperClass",this)} sn-theme-${this.toastConfig.theme} sn-type-${this.toastConfig.type} ${$(this)}`.trim()}style={{...m("wrapperStyle",this),[this.store.toasterConfig.positionX]:`${this.store.toasterConfig.offsetX}px`,[this.store.toasterConfig.positionY]:`${this.offset}px`}}>
        {}
        <Z fallback={M(this)}when={this.toastConfig.contentType==="static"}>
          <div class={m("class",this)}style={m("style",this)}>
            {H(this)}
            {M(this)}
            {L(this)}
            {j(this)}
          </div>
        </Z>
      </div>}},E=B;import{batch as le,createEffect as N,For as Ce,mergeProps as we,on as Te,onCleanup as ve,onMount as ye}from"solid-js";import{createStore as Ee}from"solid-js/store";import{createContext as ie,mergeProps as ae,onCleanup as de,onMount as ue,splitProps as fe,useContext as J}from"solid-js";function te(e,{toasterId:t,store:o,setStore:a,counter:n}){if(t==="__default")throw new Error('Toaster with toasterId "__default" is reserved and cannot be used.');if(!t)if(e.size===0)t="__default";else throw new Error("ToasterId is required when using multiple toasters.");if(e.has(t))throw new Error(`Toaster with toasterId "${t}" already exists.`);if(e.size>0&&e.has("__default"))throw new Error("When using multiple toasters, all toasters must be provided with a unique toasterId.");return e.set(t,{toasterId:t,store:o,setStore:a,counter:n}),{toasterId:t,store:o,setStore:a,counter:n}}function re(e,t){if(e.size===0)throw new Error("No toasters are currently registered. Please make sure that a toaster component has been rendered within the <ToastProvider> and registered properly.");if(!t){if(e.size===1)return Array.from(e.values())[0];throw new Error("When using multiple toasters, a toasterId must be included either in the useToast invocation or in the toast options if calling toast functions.")}let o=e.get(t);if(!o)throw new Error(`Toaster with toasterId "${t}" does not exist.`);return o}function oe(e,t){if(!e.has(t))throw new Error(`Toaster with toasterId "${t}" does not exist.`);e.delete(t)}var S={registerToaster:te,getToaster:re,unregisterToaster:oe};import{batch as se}from"solid-js";function ne(e,t){let o=(r,i)=>{t&&(i={toasterId:t,...i});let s=e.getToaster(i?.toasterId),{toasterId:d,store:c,setStore:C}=s,l=P(s.counter+=1,d,i?.id);v(l,c);let h=y(i),p=new E({store:c,setStore:C,toastConfig:{...h,contentType:typeof r=="function"?"dynamic":"static",content:r,id:l}});return p.init(),{id:l,ref:p.ref,progressControls:I(p)}},a=r=>{t&&(r={toasterId:t,...r});let{id:i,toasterId:s}=r,d=y(r);if(d.content&&(d.contentType=typeof d.content=="function"?"dynamic":"static"),!i&&!s){e.toasters.forEach(h=>{h.store.rendered.forEach(p=>p.update(d)),h.store.queued.forEach(p=>p.update(d))});return}let c=e.getToaster(s),{store:C}=c;if(s&&!i){c.store.rendered.forEach(h=>h.update(d)),c.store.queued.forEach(h=>h.update(d));return}let l=v(i,C);if(l)return l.update(d),{id:i,ref:l.ref,progressControls:I(l)}},n=r=>{if(t&&(r={toasterId:t,...r}),!r){e.toasters.forEach(s=>{s.store.rendered.forEach(d=>d.dismiss()),s.store.queued.forEach(d=>d.dismiss())});return}if(!r.toasterId&&!r.id&&r.keepQueued){e.toasters.forEach(s=>{s.store.rendered.forEach(d=>d.dismiss(r.reason))});return}let i=e.getToaster(r.toasterId);if(r.id){let s=v(r.id,i.store);s?.dismiss(r.reason);return}i.store.rendered.forEach(s=>s.dismiss(r.reason)),!r.keepQueued&&i.store.queued.forEach(s=>s.dismiss(r.reason))},f=r=>{if(t&&(r={toasterId:t,...r}),!r){e.toasters.forEach(s=>{se(()=>{s.setStore("rendered",[]),s.setStore("queued",[])})});return}if(!r.toasterId&&!r.id&&r.keepQueued){e.toasters.forEach(s=>{s.store.rendered.forEach(d=>d.remove())});return}let i=e.getToaster(r.toasterId);if(r.id){let s=v(r.id,i.store);if(!s)throw new Error(r.toasterId==="__default"?`Failed to remove toast: No toast found with the provided ID (${r.id}).`:`Failed to remove toast: No toast found with the provided ID (${r.id}) in the toaster with the toasterId "${r.toasterId}".`);s.remove();return}i.store.rendered.forEach(s=>s.remove()),!r.keepQueued&&i.store.queued.forEach(s=>s.remove())},u=(r,i,s)=>{t&&(s={toasterId:t,...s});let d=e.getToaster(s?.toasterId),c=y(s),C=P(d.counter+=1,s?.toasterId,s?.id),l=new E({store:d.store,setStore:d.setStore,toastConfig:{...c,id:C,type:"loading",duration:!1,contentType:"static",content:i.pending}});return l.init(),new Promise((h,p)=>{r.then(T=>{l.update({type:"success",content:typeof i.success=="function"?i.success(T):i.success,contentType:"static",duration:s?.duration||d.store.toasterConfig.duration}),h(T)},T=>{l.update({type:"error",content:typeof i.error=="function"?i.error(T):i.error,contentType:"static",duration:s?.duration||d.store.toasterConfig.duration}),p(T)})})},g=(r=t)=>{let{store:i}=e.getToaster(r);return i.queued};return{notify:o,update:a,dismiss:n,remove:f,promise:u,getQueue:g,clearQueue:(r=t)=>{r||e.toasters.forEach(s=>{s.setStore("queued",[])}),g(r).forEach(s=>s.remove())}}}var U=ne;var Y={theme:"light",type:"default",duration:5e3,onEnter:void 0,enterDuration:300,onExit:void 0,exitDuration:300,onIdle:void 0,positionY:"top",positionX:"right",offsetX:16,offsetY:16,gutter:16,limit:8,reverseToastOrder:!1,pauseOnHover:!0,pauseOnWindowInactive:!0,renderOnWindowInactive:!1,class:"sn-toast",style:void 0,wrapperClass:"sn-toast-wrapper",wrapperStyle:void 0,enterCallback:null,updateCallback:null,exitCallback:null,showDismissButton:!0,dismissButtonStyle:void 0,dismissButtonClass:"sn-dismiss-button",dismissOnClick:!1,toasterStyle:null,showProgressBar:!0,progressBarStyle:void 0,progressBarClass:"sn-progress-bar",showIcon:!0,icon:null,dragToDismiss:!0,dragTreshold:100,ariaLive:"polite",role:"status"};var k=ie();function K(e){let t=new Map,o=ae(Y,fe(e,["children"])[1]);function a(u){return S.registerToaster(t,u)}function n(u){return S.getToaster(t,u)}function f(u){return S.unregisterToaster(t,u)}return ue(()=>{typeof window>"u"||document.addEventListener("keydown",O)}),de(()=>{typeof window>"u"||document.removeEventListener("keydown",O)}),<k.Provider value={{providerProps:o,toasters:t,registerToaster:a,getToaster:n,unregisterToaster:f}}>
      {e.children}
    </k.Provider>}function R(){let e=J(k);if(!e)throw new Error("ServiceContext is not provided. Please wrap your component with <ToastProvider></ToastProvider>.");return{providerProps:e.providerProps,registerToaster:e.registerToaster,unregisterToaster:e.unregisterToaster,getToaster:e.getToaster}}function ce(e){let t=J(k);if(!t)throw new Error("ToastContext is not provided. Please wrap your component with <ToastProvider></ToastProvider>.");return U(t,e)}function z(e){let{registerToaster:t,unregisterToaster:o,providerProps:a}=R(),[n,f]=Ee({queued:[],rendered:[],toasterConfig:we(a,e),isWindowBlurred:typeof window<"u"&&document.visibilityState==="hidden"}),{toasterId:u}=t({toasterId:e.toasterId,store:n,setStore:f,counter:0});N(Te(()=>({...n.toasterConfig}),r=>[...n.queued,...n.rendered].forEach(i=>i.patch(r)))),N(()=>{if(n.isWindowBlurred&&!n.toasterConfig.renderOnWindowInactive)return;if(n.toasterConfig.limit&&n.queued.length&&n.rendered.length<n.toasterConfig.limit){let[d,...c]=n.queued;le(()=>{f("queued",c),f("rendered",[d,...n.rendered])})}let i=n.toasterConfig.reverseToastOrder?[...n.rendered].reverse():n.rendered,s=n.toasterConfig.offsetY;i.forEach(d=>{if(d.ref){let c=d.toastConfig.content;d.offset=s,s+=d.ref.clientHeight+n.toasterConfig.gutter}})});let g=()=>{f("isWindowBlurred",!0),n.toasterConfig.pauseOnWindowInactive&&n.rendered.forEach(r=>r.progressManager.pause())},w=()=>{f("isWindowBlurred",!1),n.toasterConfig.pauseOnWindowInactive&&n.rendered.forEach(r=>{r.isPausedByUser||r.progressManager.play()})};return ye(()=>{typeof window>"u"||(window.addEventListener("blur",g),window.addEventListener("focus",w))}),ve(()=>{o(u),!(typeof window>"u")&&(window.removeEventListener("blur",g),window.removeEventListener("focus",w))}),<div class="sn-toaster"id={u==="__default"?"sn-toaster":u}style={{"justify-content":D(n.toasterConfig.positionX),...n.toasterConfig.toasterStyle}}>
      <Ce each={n.rendered}>{r=>r.render()}</Ce>
    </div>}export{E as Toast,K as ToastProvider,z as Toaster,ce as useToast};
